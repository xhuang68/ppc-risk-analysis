<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title></title>

    <!-- import Bootstrap css -->
    <link rel="stylesheet" href="./static/css/bootstrap.min.css">

    <!-- import ppc-treeview css -->
    <link rel="stylesheet" href="./static/css/ppc-treeview.css">

    <!-- import jQuery & jQuery-contextMenu -->
    <script src="./static/plugins/jquery-1.11.3/jquery.min.js"></script>

    <link href="./static/plugins/jQuery-contextMenu/jquery.contextMenu.min.css" rel="stylesheet" type="text/css" />
    <script src="./static/plugins/jQuery-contextMenu/jquery.contextMenu.min.js" type="text/javascript"></script>
    <script src="./static/plugins/jQuery-contextMenu/jquery.ui.position.min.js" type="text/javascript"></script>
    <script src="./static/plugins/jQuery-contextMenu/main.js" type="text/javascript"></script>

    <!-- import Bootstrap js -->
    <script src="./static/js/bootstrap.min.js"></script>

</head>

<body>
    <div id="home-wrapper" style="height:512px;width:768px;margin:0 auto;border:1px solid #999999;">
        <div class="ppc-risk-analysis-header" style="height:10%;border-bottom:1px solid #999999;padding:10px;">
          <button class="btn btn-default btn-sm" type="button" name="button" onclick="handleBasicInfo()">基本信息</button>
          <button class="btn btn-default btn-sm" type="button" name="button" onclick="handleDictEdit()">编辑字典</button>
          <button class="btn btn-default btn-sm" type="button" name="button" onclick="handleAddRoot()">添加根数据</button>
          <button class="btn btn-default btn-sm" type="button" name="button" onclick="handlePreview()">预览</button>
          <button class="btn btn-default btn-sm" type="button" name="button" onclick="handleExport()">导出</button>
        </div>
        <div class="ppc-risk-analysis-content-wrapper" style="height:90%;vertical-align:top;">

            <div class="col-sm-6 ppc-risk-analysis-content-left" style="border-right:1px dashed #999999;width:50%;height:100%;overflow:scroll;display:inline;padding-top:10px;">
              <div class="ppc-treeview" style="width:100%">
                <ul id="ppc-node">
                  <li class="ppc-treeview-node"><input type="checkbox" id="item-0" class="level-1" /><label for="item-0">01 系统1</label>
                      <ul>
                          <li class="ppc-treeview-node"><input type="checkbox" id="item-0-0" class="level-2" /><label for="item-0-0">01 功能分区与布置</label>
                              <ul>
                                <li class="ppc-treeview-leaf" id="item-0-0-0"><a href="./" onclick="handleLeafClicked('item-0-0-0');return false;">01 主工艺区</a></li>
                                <li class="ppc-treeview-leaf" id="item-0-0-1"><a href="./" onclick="handleLeafClicked('item-0-0-1');return false;">02 辅助工艺区</a></li>
                                <li class="ppc-treeview-leaf" id="item-0-0-2"><a href="./" onclick="handleLeafClicked('item-0-0-2');return false;">03 人流控制区</a></li>
                                <li class="ppc-treeview-leaf" id="item-0-0-3"><a href="./" onclick="handleLeafClicked('item-0-0-3');return false;">04 物流控制区</a></li>
                              </ul>
                          </li>
                          <li class="ppc-treeview-node"><input type="checkbox" id="item-0-1" class="level-2" /><label for="item-0-1">02 技术系统</label>
                              <ul>
                                <li class="ppc-treeview-leaf" id="item-0-1-0"><a href="./" onclick="handleLeafClicked('item-0-1-0');return false;">01 空调系统</a></li>
                                <li class="ppc-treeview-leaf" id="item-0-1-1"><a href="./" onclick="handleLeafClicked('item-0-1-1');return false;">02 传递窗</a></li>
                              </ul>
                          </li>
                          <li class="ppc-treeview-node"><input type="checkbox" id="item-0-2" class="level-2" /><label for="item-0-2">03 控制与管理程序</label>
                              <ul>
                                <li class="ppc-treeview-leaf" id="item-0-2-0"><a href="./" onclick="handleLeafClicked('item-0-2-0');return false;">01 人流更衣程序</a></li>
                                <li class="ppc-treeview-leaf" id="item-0-2-1"><a href="./" onclick="handleLeafClicked('item-0-2-1');return false;">02 物流进出程序</a></li>
                              </ul>
                          </li>
                          <li class="ppc-treeview-node"><input type="checkbox" id="item-0-3" class="level-2" /><label for="item-0-3">04 文件</label>
                              <ul>
                                <li class="ppc-treeview-leaf" id="item-0-3-0"><a href="./" onclick="handleLeafClicked('item-0-3-0');return false;">01 URS</a></li>
                              </ul>
                          </li>
                      </ul>
                  </li>
                </ul>
              </div>
            </div>

            <div class="col-sm-6 ppc-risk-analysis-content-right" style="width:50%;height:100%;display:inline;overflow:scroll;padding:0;">
              <div class="right-header" style="position:fixed;z-index:3;height:50px;width:383px;color:white;background:rgba(238, 241, 246, 0.8);text-align:center;line-height:50px;text-decoration: none;">
                <div class="" style="display:inline-block;width:270px;overflow:scroll;">
                  <p class="right-header-breadcrumb" style="margin-bottom:0;color:black;white-space:nowrap;vertical-align:top;" title="1系统1/1功能分区与布置/01主工艺分区">01主工艺分区</p>
                </div>
                <div class="dropdown" style="display:inline-block;width:80px;vertical-align:top;">
                  <button id="dLabel" class="btn btn-default btn-sm" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="">
                    新建条目
                    <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" aria-labelledby="dLabel">
                    <li><a href="#" onclick="handleAddItem(0);return false;">空白模板</a></li>
                    <li><a href="#" onclick="handleAddItem(1);return false;"=>模板名称1</a></li>
                    <li><a href="#" onclick="handleAddItem(2);return false;">模板名称2</a></li>
                    <li><a href="#" onclick="handleAddItem(3);return false;">模板名称3</a></li>
                  </ul>
                </div>
              </div>

              <div class="right-lists" style="margin:0 15px;margin-top:70px;">
                <div class="list-group">
                  <a href="./analysis.html" class="list-group-item">
                    <p class="list-group-item-heading">功能名称</p>
                    <hr style="margin:0px;">
                    <p class="list-group-item-text" style="margin:15px 0;">
                      风险水平
                      <span style="margin-left:52px;font-size:20px;font-weight:500;">
                        RL >= 6
                      </span>
                      <span class="label label-danger" style="margin-left:20px;font-size:15px;font-weight:300;">
                        高风险
                      </span>
                    </p>

                    <p class="list-group-item-text" style="margin:15px 0;">
                      措施后风险水平
                      <span style="margin-left:10px;font-size:20px;font-weight:500;">
                        RL <= 2
                      </span>
                      <span class="label label-success" style="margin-left:20px;font-size:15px;font-weight:300;">
                        低风险
                      </span>
                    </p>
                  </a>
                </div>
                <div class="list-group">
                  <a href="./analysis.html" class="list-group-item">
                    <p class="list-group-item-heading">功能名称</p>
                    <hr style="margin:0px;">
                    <p class="list-group-item-text" style="margin:15px 0;">
                      风险水平
                      <span style="margin-left:52px;font-size:20px;font-weight:500;">
                        RL >= 6
                      </span>
                      <span class="label label-danger" style="margin-left:20px;font-size:15px;font-weight:300;">
                        高风险
                      </span>
                    </p>

                    <p class="list-group-item-text" style="margin:15px 0;">
                      措施后风险水平
                      <span style="margin-left:10px;font-size:20px;font-weight:500;">
                        RL <= 2
                      </span>
                      <span class="label label-success" style="margin-left:20px;font-size:15px;font-weight:300;">
                        低风险
                      </span>
                    </p>
                  </a>
                </div>
                <div class="list-group">
                  <a href="./analysis.html" class="list-group-item">
                    <p class="list-group-item-heading">功能名称</p>
                    <hr style="margin:0px;">
                    <p class="list-group-item-text" style="margin:15px 0;">
                      风险水平
                      <span style="margin-left:52px;font-size:20px;font-weight:500;">
                        RL >= 6
                      </span>
                      <span class="label label-danger" style="margin-left:20px;font-size:15px;font-weight:300;">
                        高风险
                      </span>
                    </p>

                    <p class="list-group-item-text" style="margin:15px 0;">
                      措施后风险水平
                      <span style="margin-left:10px;font-size:20px;font-weight:500;">
                        RL <= 2
                      </span>
                      <span class="label label-success" style="margin-left:20px;font-size:15px;font-weight:300;">
                        低风险
                      </span>
                    </p>
                  </a>
                </div>
                <div class="list-group">
                  <a href="./analysis.html" class="list-group-item">
                    <p class="list-group-item-heading">功能名称</p>
                    <hr style="margin:0px;">
                    <p class="list-group-item-text" style="margin:15px 0;">
                      风险水平
                      <span style="margin-left:52px;font-size:20px;font-weight:500;">
                        RL >= 6
                      </span>
                      <span class="label label-danger" style="margin-left:20px;font-size:15px;font-weight:300;">
                        高风险
                      </span>
                    </p>

                    <p class="list-group-item-text" style="margin:15px 0;">
                      措施后风险水平
                      <span style="margin-left:10px;font-size:20px;font-weight:500;">
                        RL <= 2
                      </span>
                      <span class="label label-success" style="margin-left:20px;font-size:15px;font-weight:300;">
                        低风险
                      </span>
                    </p>
                  </a>
                </div>
              </div>
            </div>
        </div>
    </div>

    <!-- ppc-treeview 组件 js 代码 -->
    <script src="./static/js/ppc-treeview.js"></script>

    <!-- 全局 js 变量和方法 -->
    <script type="text/javascript">
      var selectedItemId; // 记录已单击内容
    </script>

    <!-- 事件处理器代码 -->
    <script type="text/javascript">
      function handleBasicInfo(){
        // TODO: 传递数据到基本信息页面
        location.href = './info.html';
      }

      function handlePreview() {

      }

      function handleExport(){
        // TODO: 导出设置
      }

      function handleAddRoot(){
        var context = $("#ppc-node").children().last();
        if (context.length) {
          addSameLevelHandler(context);
        } else {
          var promptName = '新建 level-1 文件';
          var newName = prompt('请输入新名字', promptName);
          var newNodeId = Date.now();
          var newHtml;
          newHtml = '<li class="ppc-treeview-node"><input type="checkbox" id="' + newNodeId.toString() + '" class="level-1" /><label for="' + newNodeId.toString() + '">' + newName + '</label><ul></ul></li>'
          if (newName != null && newName != "") {
            $("#ppc-node").html(newHtml);
          }
        }
      }

      function handleDictEdit(){
        // TODO: 传递数据到字典编辑页面
      }

      function handleAddItem(templateId) {
        var promptName = '新建条目';
        var newName = prompt('请输入新名字', promptName);

        var newHtml = '<div class="list-group"><a href="./analysis.html" class="list-group-item"><p class="list-group-item-heading">' + newName + '</p><hr style="margin:0;"><p class="list-group-item-text">风险水平 <span style="margin-left:52px;font-size:20px;font-weight:500;">高 RL >= 2</span> </p><p class="list-group-item-text">措施后风险水平 <span style="margin-left:10px;font-size:20px;font-weight:500;">低 RL <= 2</span> </p></a></div>';

        if (newName != null && newName != "") {
          $('.right-lists').children().last().after(newHtml);
          // TODO: 修改数据库信息
          // TODO: 修改模板数据
          // TODO: 传递模板信息到数据库内
        }
      }

      function handleLeafClicked(itemId) {
        var level2 = findParentItemId(itemId);
        var level1= findParentItemId(level2);
        var breadcrumb = $('#' + level1).next().text() + '/' + $('#' + level2).next().text() + '/' + $('#' + itemId).text();
        $('.right-header-breadcrumb').text($('#' + itemId).text());
        $('.right-header-breadcrumb').attr('title', breadcrumb);

        if (selectedItemId) {
          $('#' + selectedItemId).removeClass('active');
        }
        selectedItemId = itemId;
        $('#' + itemId).addClass('active');

        // TODO: 传递数据到列表页面
      }

      function findParentItemId(itemId) {
        var temp = itemId.split('')
        temp.splice(itemId.length - 2, 2);
        return temp.join('');
      }
    </script>
</body>

</html>

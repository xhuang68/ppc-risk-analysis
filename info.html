<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title></title>

    <!-- import Bootstrap css -->
    <link rel="stylesheet" href="./static/css/bootstrap.min.css">

    <!-- import jQuery & jQuery-contextMenu -->
    <script src="./static/plugins/jquery-1.11.3/jquery.min.js"></script>

    <!-- import Bootstrap js -->
    <script src="./static/js/bootstrap.min.js"></script>

</head>

<body>
    <div id="info-wrapper" style="height:512px;width:768px;margin:0 auto;border:1px solid #999999;padding:20px;overflow:scroll;">

      <div class="info-form-wrapper" style="width:90%;margin:0 auto;">
        <form id="info-form" class="form-horizontal">
            <div class="form-group" style="display:flex;align-items:center;margin-bottom:20px;">
                <label for="inputSystem" class="col-sm-2 control-label" style="padding:0;">
                    表格编码<br>Form Code
                </label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="inputSystem" placeholder="表格编码 Form Code">
                </div>
            </div>
            <div class="form-group" style="display:flex;align-items:center;margin-bottom:20px;">
                <label for="inputSystem" class="col-sm-2 control-label" style="padding:0;">
                    版本号<br>Version
                </label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="inputSystem" placeholder="版本号 Version">
                </div>
            </div>
            <div class="form-group" style="display:flex;align-items:center;margin-bottom:20px;">
                <label for="inputSystem" class="col-sm-2 control-label" style="padding:0;">
                    系统名称<br>System Name
                </label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="inputSystem" placeholder="系统名称 System Name">
                </div>
            </div>
            <div class="form-group" style="display:flex;align-items:center;margin-bottom:20px;">
                <label for="inputTask" class="col-sm-2 control-label" style="padding:0;">系统任务<br>Task</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="inputTask" placeholder="系统任务 Task">
                </div>
            </div>
            <div class="form-group" style="display:flex;align-items:center;margin-bottom:20px;">
                <label for="inputEvanluater" class="col-sm-2 control-label" style="padding:0;">评估人<br>Assessor</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="inputEvanluater" placeholder="评估人 Assessor">
                </div>
            </div>
            <div class="form-group" style="display:flex;align-items:center;margin-bottom:20px;">
                <label for="inputEvanluater" class="col-sm-2 control-label" style="padding:0;">审核人<br>Reviewer</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="inputEvanluater" placeholder="评估人 Reviewer">
                </div>
            </div>

            <div class="form-group file-input" id="file-input-1" style="display:flex;align-items:center;">
              <label for="file-1" class="col-sm-2 control-label" style="padding:0;">参考图/文件<br>Reference</label>
              <div class="col-sm-9">
                <input class="form-control" name="file-1" id="file-1" placeholder="文件名称 Reference">
              </div>
              <div class="col-sm-1">
                <a href="#" style="color:black;text-decoration:none;font-size:25px;line-height:25px;" onclick="handleAddFile(1);return false;">&plus;</a>
              </div>
          </div>

        </form>
      </div>

      <div class="submit-btn" style="text-align:center;">
        <button class="btn btn-default" onclick="handleSubmit()">提交 Submit</button>
        <button class="btn btn-default" onclick="handleReturn()">返回 Back</button>
      </div>

    </div>

    <!-- 全局变量存储文件数目 js 代码 -->
    <script type="text/javascript">
      var numOfFiles = 1;
    </script>

    <!-- 全局 helper 函数 -->
    <script type="text/javascript">
      function getAllFiles () {
        var files = [];
        $('.file-input').each(function(input){
          var file = $(this).find('input').val();
          if (file !== '') {
            files.push(file);
          }
        });
        console.log(files);
      }
    </script>

    <!-- 事件处理器代码 -->
    <script type="text/javascript">
      function handleSubmit () {
        // TODO: 处理表单数据并提交跳转
        getAllFiles();
        // location.href = './home.html';
        // document.getElementById("info-form").submit();
      }

      function handleReturn () {
        // TODO: 跳转返回
        location.href = './home.html';
      }

      function handleRemoveFile(fileId) {
        $('#file-input-' + fileId).remove()
      }

      function handleAddFile(fileId) {
          var newFileId = ++numOfFiles;
          var newHtml = generateMockDOM(newFileId);
          $('#file-input-' + fileId).after(newHtml);
        }

      // 此方法仅生成 UI 伪 DOM
      function generateMockDOM(fileId) {

        var label = '<label for="file-' + fileId + '" class="col-sm-2 control-label" style="padding:0;">参考图/文件</label>';
        var input = '<input class="form-control" name="file-' + fileId + '" id="file-' + fileId + '" placeholder="文件名称 Reference">';

        var newHtml = '<div class="form-group file-input" id="file-input-' + fileId + '" style="display:flex;align-items:center;margin-bottom:20px;">' + label + '<div class="col-sm-9">' + input + '</div><div class="col-sm-1" style="padding:0;"><a href="" style="color:black;text-decoration:none;font-size:25px;line-height:25px;margin-right:10px;" onclick="handleRemoveFile(' + fileId + ');return false;">&times;</a><a href="" style="color:black;text-decoration:none;font-size:25px;line-height:25px;" onclick="handleAddFile(' + fileId + ');return false;">&plus;</a></div></div>'

        return newHtml;
      }
    </script>
</body>

</html>
